{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export function createPthotsHtml(images) {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n        <a href=${largeImageURL} class=\"gallery_link\">\n          <img src=${webformatURL} alt=${tags} loading=\"lazy\">\n          <div class=\"info\">\n            <p class=\"info-item\">\n              <b>Likes</b>\n              ${likes}\n            </p>\n            <p class=\"info-item\">\n              <b>Views</b>\n              ${views}\n\n            </p>\n            <p class=\"info-item\">\n              <b>comments</b>\n              ${comments}\n\n            </p>\n            <p class=\"info-item\">\n              <b>Downloads</b>\n              ${downloads}\n\n            </p>\n          </div>\n        </a>\n        `;\n      }\n    )\n    .join('');\n}\n","import axios from \"axios\"\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API = \"28460995-5acfdb805ab0c27f2bf717abb\";\n\n\nexport async function loadImages(query, page = 1, perPage = 15) {\n  const params = new URLSearchParams({\n    key: API,\n    q: query,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    page,\n    per_page: perPage,\n  });\n\n  const response = await axios.get(`${BASE_URL}?${params}`);\n  return response.data;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { createPthotsHtml } from './js/render-functions';\nimport { loadImages } from './js/pixabay-api';\n\nconst refs = {\n  form: document.querySelector('#search-form'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('#loader'),\n  loadMoreBtn: document.querySelector('#load-more'),\n};\n\nlet lightbox = null;\nlet currentQuery = '';\nlet currentPage = 1;\nconst perPage = 5;\nlet totalHits = 0;\n\nrefs.loadMoreBtn.style.display = 'none';\n\nrefs.form.addEventListener('submit', onSearch);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSearch(e) {\n  e.preventDefault();\n  currentQuery = e.currentTarget.elements.search.value.trim();\n\n  if (!currentQuery) {\n    iziToast.warning({\n      title: 'Stop!',\n      message: 'The field must be filled up!!!',\n    });\n    return;\n  }\n\n  resetSearch();\n  showLoader();\n\n  try {\n    const data = await loadImages(currentQuery, currentPage, perPage);\n    hideLoader();\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        title: 'No results!',\n        message: 'Sorry, no images match your query. Try again!',\n      });\n      return;\n    }\n\n    totalHits = data.totalHits;\n    refs.gallery.innerHTML = createPthotsHtml(data.hits);\n    initializeLightbox();\n\n    if (data.hits.length < perPage || totalHits <= perPage) {\n      refs.loadMoreBtn.style.display = 'none';\n    } else {\n      refs.loadMoreBtn.style.display = 'block';\n      setLoadMoreButtonState(false);\n    }\n  } catch (error) {\n    hideLoader();\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later.',\n    });\n  }\n}\n\nasync function onLoadMore() {\n  setLoadMoreButtonState(true);\n  showLoader();\n  currentPage += 1;\n\n  try {\n    const data = await loadImages(currentQuery, currentPage, perPage);\n    hideLoader();\n\n    if (data.hits.length === 0) {\n      refs.loadMoreBtn.style.display = 'none';\n      iziToast.warning({\n        title: 'End of results',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      return;\n    }\n\n    const imagesHtml = createPthotsHtml(data.hits);\n    refs.gallery.insertAdjacentHTML('beforeend', imagesHtml);\n    lightbox.refresh();\n    smoothScroll();\n\n    if (currentPage * perPage >= totalHits) {\n      refs.loadMoreBtn.style.display = 'none';\n      iziToast.info({\n        title: 'End of results',\n        message: \"You've reached the end of available images.\",\n      });\n    } else {\n      setLoadMoreButtonState(false);\n    }\n  } catch (error) {\n    hideLoader();\n    setLoadMoreButtonState(false);\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later.',\n    });\n  }\n}\n\nfunction resetSearch() {\n  currentPage = 1;\n  totalHits = 0;\n  refs.gallery.innerHTML = '';\n  refs.loadMoreBtn.style.display = 'none';\n  refs.form.reset();\n}\n\nfunction showLoader() {\n  refs.loader.classList.add('visible');\n}\n\nfunction hideLoader() {\n  refs.loader.classList.remove('visible');\n}\n\nfunction initializeLightbox() {\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a');\n  } else {\n    lightbox.refresh();\n  }\n}\n\nfunction smoothScroll() {\n  const { height } = refs.gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction setLoadMoreButtonState(isLoading) {\n  if (isLoading) {\n    refs.loadMoreBtn.disabled = true;\n    refs.loadMoreBtn.textContent = 'Loading...';\n  } else {\n    refs.loadMoreBtn.disabled = false;\n    refs.loadMoreBtn.textContent = 'Load more';\n  }\n}\n"],"names":["createPthotsHtml","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","BASE_URL","API","loadImages","query","page","perPage","params","axios","refs","lightbox","currentQuery","currentPage","totalHits","onSearch","onLoadMore","e","iziToast","resetSearch","showLoader","data","hideLoader","initializeLightbox","setLoadMoreButtonState","imagesHtml","smoothScroll","SimpleLightbox","height","isLoading"],"mappings":"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"}